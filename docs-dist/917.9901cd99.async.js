"use strict";(self.webpackChunktree_graph=self.webpackChunktree_graph||[]).push([[917],{56917:function(dt,re,s){s.r(re),s.d(re,{BaseTreeGraph:function(){return at}});var fe=s(26068),b=s.n(fe),f=s(39546),h=s(81412),pe=s(17069),x=s.n(pe),ge=s(25298),S=s.n(ge),me=s(21742),W=s.n(me),ye=s(83136),R=s.n(ye),U=function(n){W()(e,n);var t=R()(e);function e(){return S()(this,e),t.apply(this,arguments)}return x()(e)}(h.NB);(function(n){function t(e){var i=[],r=h.Lu.getForeignObjectMarkup();return e?i.push.apply(i,[{tagName:e,selector:"body"},r]):i.push(r),i}U.config({view:"react-shape-view",markup:t(),attrs:{body:{fill:"none",stroke:"none",refWidth:"100%",refHeight:"100%"},fo:{refWidth:"100%",refHeight:"100%"}},propHooks:function(i){if(i.markup==null){var r=i.primer;if(r){i.markup=t(r);var o={};switch(r){case"circle":o={refCx:"50%",refCy:"50%",refR:"50%"};break;case"ellipse":o={refCx:"50%",refCy:"50%",refRx:"50%",refRy:"50%"};break;default:break}i.attrs=h.QK.merge({},{body:b()({refWidth:null,refHeight:null},o)},i.attrs||{})}}return i}}),h.NB.registry.register("react-shape",U,!0)})(U||(U={}));var Ce=s(62657),ke=s.n(Ce),be=s(9504),G=s.n(be),xe=s(38836),B=s.n(xe),Se=s(82092),$=s.n(Se),We=s(68428),Re=s(50828),Ee=s(67825),Ne=s.n(Ee),Y=function(t,e){return"".concat(e?"".concat(e,"@"):"").concat(t)},Me=["shape","component","effect","inherit"],D={};function we(n,t){var e=n.shape,i=n.component,r=n.effect,o=n.inherit,a=Ne()(n,Me);if(!e)throw new Error("should specify shape in config");var l=Y(e,t);i&&(D[l]={component:i,effect:r}),h.kJ.registerNode(l,b()({inherit:o||"react-shape"},a),!0)}function ne(n,t){var e=Y(n,t);return h.NB.registry.get(e)||h.NB.registry.get(n)}function Te(n,t){var e=Y(n,t);D[e]&&(delete D[e],h.kJ.unregisterNode(e))}function ct(n){Object.keys(D).forEach(function(t){new RegExp("^".concat(n,"@")).test(t)&&(delete D[t],Graph.unregisterNode(t))})}var O=s(74132),Fe=function(n){W()(e,n);var t=R()(e);function e(i){var r;return S()(this,e),r=t.call(this,i),r.state={tick:0},r}return x()(e,[{key:"componentDidMount",value:function(){var r=this,o=this.props,a=o.node,l=o.graph;a.on("change:*",function(u){var v=u.key,d=a.shape,c=Y(d,l.id),p=D[c]||D[d];if(p){var g=p.effect;(!g||g.includes(v))&&r.setState({tick:r.state.tick+1})}})}},{key:"clone",value:function(r){var o=this.props,a=o.node,l=o.graph;return typeof r.type=="string"?f.cloneElement(r):f.cloneElement(r,{node:a,graph:l})}},{key:"render",value:function(){var r=this.props.node,o=D[r.shape];if(!o)return null;var a=o.component;if(f.isValidElement(a))return this.clone(a);var l=a;return this.clone((0,O.jsx)(l,{}))}}]),e}(f.PureComponent),Z=function(n){W()(e,n);var t=R()(e);function e(){var i;S()(this,e);for(var r=arguments.length,o=new Array(r),a=0;a<r;a++)o[a]=arguments[a];return i=t.call.apply(t,[this].concat(o)),$()(ke()(i),"root",void 0),i}return x()(e,[{key:"targetId",value:function(){return"".concat(this.graph.view.cid,":").concat(this.cell.id)}},{key:"getComponentContainer",value:function(){return this.selectors&&this.selectors.foContent}},{key:"confirmUpdate",value:function(r){var o=this,a=G()(B()(e.prototype),"confirmUpdate",this).call(this,r);return this.handleAction(a,e.action,function(){o.renderReactComponent()})}},{key:"renderReactComponent",value:function(){this.unmountReactComponent();var r=this.getComponentContainer(),o=this.cell;if(r){var a,l=f.createElement(Fe,{node:o,graph:this.graph}),u=(a=this.graph.portal)===null||a===void 0?void 0:a.connect;if(u){var v=(0,We.createPortal)(l,r,o.id);u(this.targetId(),v)}else this.root=(0,Re.createRoot)(r),this.root.render(l)}}},{key:"unmountReactComponent",value:function(){var r=this.getComponentContainer();r&&this.root&&(this.root.unmount(),this.root=void 0)}},{key:"onMouseDown",value:function(r,o,a){var l=r.target,u=l.tagName.toLowerCase();if(u==="input"){var v=l.getAttribute("type");if(v==null||["text","password","number","email","search","tel","url"].includes(v))return}G()(B()(e.prototype),"onMouseDown",this).call(this,r,o,a)}},{key:"unmount",value:function(){var r,o=(r=this.graph.portal)===null||r===void 0?void 0:r.disconnect;return o&&o(this.targetId()),this.unmountReactComponent(),G()(B()(e.prototype),"unmount",this).call(this),this}}]),e}(h.DK);(function(n){var t=n.action="react";Z.config({bootstrap:[t],actions:{component:t}}),h.DK.registry.register("react-shape-view",Z,!0)})(Z||(Z={}));var ze=s(48305),ie=s.n(ze),Ae=s(15558),K=s.n(Ae),$e=function(t,e){var i=e.payload;switch(e.type){case"add":{var r=t.findIndex(function(l){return l.id===i.id});return r>=0?(t[r]=i,K()(t)):[].concat(K()(t),[i])}case"remove":{var o=t.findIndex(function(l){return l.id===i.id});if(o>=0){var a=K()(t);return a.splice(o,1),a}break}default:break}return t};function De(){var n=(0,f.useReducer)($e,[]),t=ie()(n,2),e=t[0],i=t[1],r=(0,f.useMemo)(function(){return e.map(function(l){return l.portal})},[e]),o=(0,f.useCallback)(function(l){i({type:"remove",payload:{id:l}})},[]),a=(0,f.useCallback)(function(l,u){i({type:"add",payload:{id:l,portal:u}})},[]);return{portals:r,disconnect:o,connect:a}}var Ge=s(1807),Be=s(23739),Oe=s(74355),Pe=s.n(Oe),je=function n(t){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},r=arguments.length>3&&arguments[3]!==void 0?arguments[3]:[],o=arguments.length>4&&arguments[4]!==void 0?arguments[4]:!0,a=arguments.length>5?arguments[5]:void 0;if(t){var l,u,v,d,c=t.data,p=t.children,g=t.x,E=t.y,N=c.id,M=c.width,w=c.height;i[N]={parents:r,children:c.children};var C=(l=c.expanded)!==null&&l!==void 0?l:!1;e.push(h.NB.create({id:c.id,shape:c.type==="topic-child"?"topic-child":"topic",x:g,y:E,width:M,height:w,label:c.label,type:c.type,expanded:C,visible:o,ellipsis:c.ellipsis,data:b()({childCount:(u=(v=c.childCount)!==null&&v!==void 0?v:(d=c.children)===null||d===void 0?void 0:d.length)!==null&&u!==void 0?u:0},a)})),p&&p.forEach(function(k){e.push(h.kS.create({shape:"base-edge",source:t.id,target:k.id,zIndex:0})),n(k,e,i,[].concat(K()(r),[c]),o&&C,a)})}return{cells:e,$ref:i}},He=function(t,e){return je(t,[],{},[],!0,e)},Ie=document.createElement("canvas"),oe=Ie.getContext("2d");function X(n){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"14px Arial, helvetica, sans-serif";return oe.font=t,oe.measureText(n).width}function Ve(n,t,e){var i=X(n,e);return i>t}var _=new Map,ae="...";function Le(n){if(_.has(n))return _.get(n);var t=X(ae,n);return _.set(n,t),t}function vt(n,t,e){if(!Ve(n,t,e))return n;for(var i=Le(e),r=t-i,o=0,a=n.length;o<=a;){var l=Math.floor((o+a)/2),u=n.substring(0,l);X(u)<=r?o=l+1:a=l-1}return n.substring(0,a)+ae}var le=16;function Je(n,t){var e="".concat(t.fontSize,"px ").concat(t.fontFamily),i=X(n,e);return i+le*2}function Ue(n,t,e,i){var r,o,a,l,u,v,d,c,p=n.type,g=n.label,E=g===void 0?"":g,N=ne(p,i),M=N==null?void 0:N.getDefaults(),w=(r=(o=n.width)!==null&&o!==void 0?o:e==null?void 0:e.width)!==null&&r!==void 0?r:M==null||(a=M.size)===null||a===void 0?void 0:a.width,C=(l=w==="auto"?Je(E,t):w)!==null&&l!==void 0?l:0,k=(u=(v=n.minWidth)!==null&&v!==void 0?v:e==null?void 0:e.minWidth)!==null&&u!==void 0?u:C,te=(d=(c=n.maxWidth)!==null&&c!==void 0?c:e==null?void 0:e.maxWidth)!==null&&d!==void 0?d:C,q=Math.min(Math.max(C,k),te);return n.width=q,q}function Ye(n,t,e,i){var r,o,a,l=n.type,u=ne(l,i),v=u==null?void 0:u.getDefaults(),d=(r=(o=n.height)!==null&&o!==void 0?o:e==null?void 0:e.height)!==null&&r!==void 0?r:v==null||(a=v.size)===null||a===void 0?void 0:a.height;return n.height=d,d}function Ze(n,t,e){var i=e==null?void 0:e.nodeConfig,r=e==null?void 0:e.themeConfig,o=Pe().mindmap(n,{direction:"H",getHeight:function(l){return Ye(l,r,i,t)},getWidth:function(l){return Ue(l,r,i,t)},getHGap:function(){return 40},getVGap:function(){return 20},getSide:function(){return"right"}});return He(o,r)}var Ke=s(65852),Xe=s(90541),Qe=Xe.Selection,qe=new Qe,_e=function(t){var e,i,r;return b()(b()({},t),{},{fontSize:(e=t==null?void 0:t.fontSize)!==null&&e!==void 0?e:14,fontFamily:(i=t==null?void 0:t.fontFamily)!==null&&i!==void 0?i:"Arial, helvetica, sans-serif",primaryColor:(r=t==null?void 0:t.primaryColor)!==null&&r!==void 0?r:"#5F95FF"})},et=s(79325),tt=(0,f.forwardRef)(function(n,t){var e=n.tooltip;return(0,f.useEffect)(function(){typeof t=="function"&&t(e==null?void 0:e.target)},[e]),null}),rt=function(t){var e=t.graph,i=(0,f.useState)(),r=ie()(i,2),o=r[0],a=r[1];return(0,f.useEffect)(function(){e.on("node:mouseover",function(l){var u=l.e,v=l.node,d=u.target,c=d.getAttribute("hoverable");if(c==="true"){var p=d.parentElement,g=p==null?void 0:p.querySelector("text");if(g){var E=v.label||"";g.textContent!==E&&a({title:E,target:d})}}}),e.on("node:mouseout",function(l){var u=l.e,v=l.node,d=u.target,c=d.getAttribute("hoverable");c==="true"&&a(void 0)})},[]),(0,O.jsx)(et.Z,{title:o==null?void 0:o.title,open:!!o,children:(0,O.jsx)(tt,{tooltip:o})})},nt=rt;function it(){var n=document.createElement("div");return n.className="graph-root",n}function ot(n){var t=n.onNodeClick,e=n.treeData,i=n.graph,r=n.theme,o=n.nodeConfig,a=n.width,l=a===void 0?"100%":a,u=n.height,v=u===void 0?"100%":u,d=(0,f.useRef)(null),c=De(),p=c.portals,g=c.connect,E=c.disconnect,N=(0,f.useRef)(void 0),M=(0,f.useRef)(_e(r)).current,w=(0,Ge.Z)(t),C=(0,f.useMemo)(function(){return Ke.kf.uuid()},[]),k=(0,f.useMemo)(function(){var m,T,j,I=it(),F=new h.kJ(b()(b()({},i),{},{panning:(m=i==null?void 0:i.panning)!==null&&m!==void 0?m:{enabled:!0,eventTypes:["leftMouseDown"]},container:I,background:(T=i==null?void 0:i.background)!==null&&T!==void 0?T:{color:"#F2F7FA"},connecting:{router:"manhattan",connector:{name:"rounded",args:{radius:4}}},interacting:(j=i==null?void 0:i.interacting)!==null&&j!==void 0?j:!1}));return F.use(qe),F.id=C,F.portal={connect:g,disconnect:E},F.defineFilter({id:"topic-hover-shadow",name:"highlight",args:{width:2,blur:3,opacity:.2,color:M.primaryColor}}),F.defineFilter({id:"sub-topic-hover-shadow",name:"dropShadow",args:{dx:0,dy:0,blur:2,opacity:.7,color:M.primaryColor}}),F.on("topic:collapse",function(z){var A=z.node;A.toggleExpanded()}),F.on("node:mouseover",function(z){var A=z.e,H=z.node,V=A.target,L=V.getAttribute("hoverable");if(L==="true"){var y,J;(y=(J=H).onMouseOver)===null||y===void 0||y.call(J)}}),F.on("node:mouseout",function(z){var A=z.e,H=z.node,V=A.target,L=V.getAttribute("hoverable");if(L==="true"){var y,J;(y=(J=H).onMouseOut)===null||y===void 0||y.call(J)}}),F.on("topic:click",function(z){var A,H,V=z.node,L=V.id,y=(A=N.current)===null||A===void 0?void 0:A[L];(H=w.current)===null||H===void 0||H.call(w,{parents:(y==null?void 0:y.parents)||[],children:(y==null?void 0:y.children)||[],eventArg:z})}),F},[]),te=(0,Be.Z)(function(){if(e){var m,T=Ze(e,C,{themeConfig:M,nodeConfig:o}),j=T.cells,I=T.$ref;N.current=I,(m=k.model.getLastCell())===null||m===void 0||m.removeZIndex(),k.resetCells(j)}});(0,f.useEffect)(function(){var m,T;d.current.append(k.container);var j=(m=d.current)===null||m===void 0?void 0:m.clientWidth,I=(T=d.current)===null||T===void 0?void 0:T.clientHeight;return k.resize(j,I),function(){k.dispose(!0)}},[]),(0,f.useEffect)(function(){te(),k.zoomToFit({padding:10,maxScale:1})},[e]);var q=(0,f.useCallback)(function(m){we(m,C)},[]),lt=(0,f.useCallback)(function(m){Te(m,C)},[]),st=(0,f.useCallback)(function(){return k},[]),ut=(0,f.useMemo)(function(){return(0,O.jsxs)(O.Fragment,{children:[p,(0,O.jsx)("div",{ref:d,style:{width:l,height:v,position:"relative"}}),(0,O.jsx)(nt,{graph:k})]})},[p]);return{GraphView:ut,register:q,unRegister:lt,getGraph:st}}var P=s(32699),se=function(n){W()(e,n);var t=R()(e);function e(){return S()(this,e),t.apply(this,arguments)}return x()(e,[{key:"preprocess",value:function(r,o){var a,l,u,v,d,c,p=r.width,g=r.height,E=r.label,N=r.ellipsis,M=this.constructor,w=M.getDefaults(),C=N&&E?{attrs:{label:{textWrap:b()(b()({text:E,width:-le},N==="multiLine"?{}:{height:((a=(l=r.data)===null||l===void 0?void 0:l.fontSize)!==null&&a!==void 0?a:14)+6}),{},{ellipsis:!0,breakWord:!1})}}}:{};return G()(B()(e.prototype),"preprocess",this).call(this,b()(b()(b()({},r),C),{},{width:(u=p!=null?p:(v=w.size)===null||v===void 0?void 0:v.width)!==null&&u!==void 0?u:1,height:(d=g!=null?g:(c=w.size)===null||c===void 0?void 0:c.height)!==null&&d!==void 0?d:1}),o)}}]),e}(h.bn.UL),ee=function(n){W()(e,n);var t=R()(e);function e(){var i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return S()(this,e),t.call(this,i)}return x()(e,[{key:"setup",value:function(){G()(B()(e.prototype),"setup",this).call(this)}},{key:"init",value:function(){G()(B()(e.prototype),"init",this).call(this),this.initTheme(),this.updateChildCount(),this.toggleExpanded(this.isExpanded())}},{key:"initTheme",value:function(){var r=this.getData(),o=r.fontSize,a=r.fontFamily,l=r.primaryColor;o&&this.attr("label/fontSize",o),a&&this.attr("label/fontFamily",a),l&&(this.attr("body/stroke",l),this.attr("collapseIcon/stroke",l))}},{key:"updateChildCount",value:function(){var r,o=(r=this.getData())===null||r===void 0?void 0:r.childCount;this.attr("collapseBtn/display",o?"block":"none"),this.attr("childCount/display",o?"block":"none"),o&&this.setAttrByPath("childCount/text",o)}},{key:"postprocess",value:function(){}},{key:"isExpanded",value:function(){var r;return(r=this.store.get("expanded"))!==null&&r!==void 0?r:!1}},{key:"updateCollapseState",value:function(){var r,o=this,a=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this,l=this.isExpanded(),u=(r=this.model)===null||r===void 0?void 0:r.graph;if(u){var v=u.getSuccessors(a,{distance:1});v&&v.forEach(function(d){d.toggleVisible(l),d instanceof o.constructor&&d.isExpanded()&&o.updateCollapseState(d)})}}},{key:"toggleExpanded",value:function(r){var o=r===void 0?!this.isExpanded():r;o?this.attr("collapseIcon",{d:"M 2 5 8 5",strokeWidth:1.8}):this.attr("collapseIcon",{d:"M 1 5 9 5 M 5 1 5 9",strokeWidth:1.6}),this.store.set("expanded",o,{silent:!0}),this.updateCollapseState()}}]),e}(se);$()(ee,"defaults",(0,P.merge)({},h.bn.UL.defaults,{markup:[{tagName:"rect",selector:"body"},{tagName:"text",selector:"label"},{tagName:"g",selector:"collapseBtn",children:[{tagName:"rect",selector:"collapseRect",attrs:{"pointer-events":"visiblePainted"}},{tagName:"path",selector:"collapseIcon",attrs:{fill:"none","pointer-events":"none"}}]},{tagName:"text",selector:"childCount"}],attrs:{childCount:{ref:"body",refX:"100%",refY:"50%",height:18,textAnchor:"start",x:2,y:-20,fill:"#333"},collapseBtn:{ref:"body",refX:"100%",refY:"50%"},collapseRect:{fill:"#fff",stroke:"#d9d9d9",strokeWidth:1,x:1,y:-9,height:18,width:18,cursor:"pointer",event:"topic:collapse"},collapseIcon:{refX:5,refY:-5,strokeWidth:1.6,stroke:"#1677ff",d:"M 1 5 9 5 M 5 1 5 9"}},zIndex:2}));var Q=function(n){W()(e,n);var t=R()(e);function e(){return S()(this,e),t.apply(this,arguments)}return x()(e,[{key:"init",value:function(){G()(B()(e.prototype),"init",this).call(this)}},{key:"onMouseOver",value:function(){this.attr("body/filter","url(#topic-hover-shadow)")}},{key:"onMouseOut",value:function(){this.attr("body/filter","none")}}]),e}(ee);$()(Q,"defaults",(0,P.merge)({},ee.defaults,{attrs:{body:{rx:6,ry:6,stroke:"#5F95FF",fill:"#EFF4FF",strokeWidth:1,cursor:"pointer",event:"topic:click",hoverable:!0,class:"x6-selected-rect"},label:{fontSize:14,fill:"#262626","pointer-events":"none"}},size:{width:160,height:50}})),h.kJ.registerNode("topic",Q,!0);var ue=function(n){W()(e,n);var t=R()(e);function e(){return S()(this,e),t.apply(this,arguments)}return x()(e)}(Q);$()(ue,"defaults",(0,P.merge)({},Q.defaults,{size:{width:100,height:40}})),h.kJ.registerNode("topic-branch",ue,!0);var de=function(n){W()(e,n);var t=R()(e);function e(){return S()(this,e),t.apply(this,arguments)}return x()(e,[{key:"onMouseOver",value:function(){this.attr("line/filter","url(#sub-topic-hover-shadow)")}},{key:"onMouseOut",value:function(){this.attr("line/filter","none")}}]),e}(se);$()(de,"defaults",(0,P.merge)({},h.bn.UL.defaults,{markup:[{tagName:"rect",selector:"body"},{tagName:"text",selector:"label"},{tagName:"rect",selector:"line"}],attrs:{body:{refY:"-50%",fill:"transparent",strokeWidth:0,event:"topic:click",cursor:"pointer",hoverable:!0},label:{fontSize:14,fill:"#262626",textVerticalAnchor:"bottom","pointer-events":"none"},line:{refWidth:"100%",fill:"#5F95FF",refY:"50%",refY2:-1,strokeWidth:0,height:2,"pointer-events":"none",class:"x6-selected-line"}},size:{width:60,height:30}})),h.kJ.registerNode("topic-child",de,!0);var ce=function(n){W()(e,n);var t=R()(e);function e(){return S()(this,e),t.apply(this,arguments)}return x()(e)}(h.bn.kS);$()(ce,"defaults",(0,P.merge)({},h.bn.kS.defaults,{attrs:{line:{targetMarker:"",stroke:"#A2B1C3",strokeWidth:2}}},{shape:"base-edge"})),h.kJ.registerEdge("base-edge",ce,!0);var ve=function(n){W()(e,n);var t=R()(e);function e(){return S()(this,e),t.apply(this,arguments)}return x()(e)}(h.bn.kS);$()(ve,"defaults",(0,P.merge)({},h.bn.kS.defaults,{attrs:{line:{stroke:"#A2B1C3",strokeWidth:2}}},{shape:"target-arrow-edge"})),h.kJ.registerEdge("target-arrow-edge",ve,!0);var he=function(n){W()(e,n);var t=R()(e);function e(){return S()(this,e),t.apply(this,arguments)}return x()(e)}(h.bn.kS);$()(he,"defaults",(0,P.merge)({},h.bn.kS.defaults,{attrs:{line:{sourceMarker:"block",targetMarker:"",stroke:"#A2B1C3",strokeWidth:2}}},{shape:"source-arrow-edge"})),h.kJ.registerEdge("source-arrow-edge",he,!0);function at(n){var t=ot(n),e=t.GraphView,i=t.register,r=t.unRegister,o=t.getGraph;return e}}}]);
